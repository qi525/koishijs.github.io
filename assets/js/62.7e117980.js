(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{392:function(t,s,a){"use strict";a.r(s);var l=a(25),c=Object(l.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"运行状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行状态"}},[t._v("#")]),t._v(" 运行状态 (Status)")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("要使用本插件，你需要安装 mysql 或 mongo 数据库支持。")])]),t._v(" "),a("p",[t._v("koishi-plugin-status 可以用于查看机器人的运行状态。")]),t._v(" "),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("你的状态")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[a("p",[t._v("5 名四季酱正在为 20 个群和 2409 名用户提供服务。")]),t._v(" "),a("p",[t._v("四季酱 2 号：工作中（2/min）")]),t._v(" "),a("p",[t._v("四季酱 3 号：工作中（3/min）")]),t._v(" "),a("p",[t._v("四季酱 4 号：工作中（3/min）")]),t._v(" "),a("p",[t._v("四季酱 5 号：工作中（0/min）")]),t._v(" "),a("p",[t._v("四季酱 9 号：工作中（5/min）")]),t._v(" "),a("p",[t._v("==========")]),t._v(" "),a("p",[t._v("更新时间：2019-12-8 14:41:15")]),t._v(" "),a("p",[t._v("启动时间：2019-12-8 14:52:12")]),t._v(" "),a("p",[t._v("已运行 43 天 10 小时 22 分钟")]),t._v(" "),a("p",[t._v("已载入指令：105")]),t._v(" "),a("p",[t._v("已载入中间件：8")]),t._v(" "),a("p",[t._v("CPU 使用率：1% / 2%")]),t._v(" "),a("p",[t._v("内存使用率：34% / 91%")])])],1),t._v(" "),a("h2",{attrs:{id:"指令：status"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令：status"}},[t._v("#")]),t._v(" 指令：status")]),t._v(" "),a("ul",[a("li",[t._v("快捷调用：你的状态，查看状态，运行情况，运行状态")])]),t._v(" "),a("p",[t._v("查看机器人的运行状态并输出。")]),t._v(" "),a("h2",{attrs:{id:"web-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-api"}},[t._v("#")]),t._v(" Web API")]),t._v(" "),a("p",[t._v("本插件还提供了一个 Web API，访问 "),a("code",[t._v("http://localhost:{port}/status")]),t._v("，即可获得 JSON 格式的运行状态：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:""}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("interface")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("BotStatus")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  type")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("string")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  selfId")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  label")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("string")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  code")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])]),t._v("\n\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("interface")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("PerfRate")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  app")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  total")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])]),t._v("\n\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("interface")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("Status")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  activeUsers")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  bots")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("BotStatus")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("[]")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  memory")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("PerfRate")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  cpu")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("PerfRate")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  timestamp")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  startTime")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("number")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("h2",{attrs:{id:"扩展-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展-api"}},[t._v("#")]),t._v(" 扩展 API")]),t._v(" "),a("p",[t._v("你可以扩展 status 返回的结果，可配合 "),a("a",{attrs:{href:"#format"}},[t._v("format")]),t._v(" 选项使用：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:""}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("const")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" { extend } ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("require")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("(")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'koishi-plugin-status'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(")")])]),t._v("\n\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#A6E22E"}},[t._v("extend")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("(")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("function")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("status")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("config")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  status.foo ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'bar'")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("})")])])])])]),a("h2",{attrs:{id:"app-构造选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#app-构造选项"}},[t._v("#")]),t._v(" App 构造选项")]),t._v(" "),a("h3",{attrs:{id:"options-bots-label"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#options-bots-label"}},[t._v("#")]),t._v(" options(.bots[]).label")]),t._v(" "),a("ul",[a("li",[t._v("类型: "),a("code",[t._v("string")])]),t._v(" "),a("li",[t._v("默认值: "),a("code",[t._v("selfId")])])]),t._v(" "),a("p",[t._v("你可以给每个机器人一个不同的标签，例如上面的例子中的“四季酱 2 号”。")]),t._v(" "),a("h2",{attrs:{id:"配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置项"}},[t._v("#")]),t._v(" 配置项")]),t._v(" "),a("h3",{attrs:{id:"path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#path"}},[t._v("#")]),t._v(" path")]),t._v(" "),a("ul",[a("li",[t._v("类型: "),a("code",[t._v("string")])]),t._v(" "),a("li",[t._v("默认值: "),a("code",[t._v("'/status'")])])]),t._v(" "),a("p",[t._v("Web API 服务的路径。")]),t._v(" "),a("h3",{attrs:{id:"refresh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#refresh"}},[t._v("#")]),t._v(" refresh")]),t._v(" "),a("ul",[a("li",[t._v("类型: "),a("code",[t._v("number")])]),t._v(" "),a("li",[t._v("默认值: "),a("code",[t._v("60000")])])]),t._v(" "),a("p",[t._v("内置缓存的刷新间隔，单位为毫秒。")]),t._v(" "),a("h3",{attrs:{id:"format"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#format"}},[t._v("#")]),t._v(" format")]),t._v(" "),a("ul",[a("li",[t._v("类型: "),a("code",[t._v("string")])]),t._v(" "),a("li",[t._v("默认值:")])]),t._v(" "),a("div",{pre:!0},[a("panel-view",{pre:!0,attrs:{class:"code",title:"",style:""}},[a("pre",[a("code",[t._v('{{ bots }}\n==========\n活跃用户数量：{{ activeUsers }}\n启动时间：{{ new Date(startTime).toLocaleString("zh-CN", { hour12: false }) }}\nCPU 使用率：{{ (cpu.app * 100).toFixed() }}% / {{ (cpu.total * 100).toFixed() }}%\n内存使用率：{{ (memory.app * 100).toFixed() }}% / {{ (memory.total * 100).toFixed() }}%\n')])])])],1),a("p",[t._v("status 指令的输出样式。")]),t._v(" "),a("h3",{attrs:{id:"formatbot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#formatbot"}},[t._v("#")]),t._v(" formatBot")]),t._v(" "),a("div",{pre:!0},[a("ul",[a("li",[t._v("类型: "),a("code",[t._v("string")])]),t._v(" "),a("li",[t._v("默认值: "),a("code",[t._v("'{{ label || selfId }}：{{ code ? `无法连接` : `工作中（${rate}/min）` }}'")])])])]),a("p",[t._v("status 指令对单个机器人的输出样式。")])],1)}),[],!1,null,null,null);s.default=c.exports}}]);