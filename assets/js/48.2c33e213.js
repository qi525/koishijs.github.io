(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{407:function(t,s,a){"use strict";a.r(s);var c=a(25),l=Object(c.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"消息的响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#消息的响应"}},[t._v("#")]),t._v(" 消息的响应")]),t._v(" "),a("h2",{attrs:{id:"配置内置问答"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置内置问答"}},[t._v("#")]),t._v(" 配置内置问答")]),t._v(" "),a("p",[t._v("respondent 插件允许设置一套内置问答，就像这样：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:"koishi.config.js"}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("module")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("exports")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  plugins: [[")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'common'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    respondent: [{")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      match: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'awsl'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      reply: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'爱我苏联'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    }, {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      match:")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v(" /")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("^")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("\\s")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("*")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("(")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("\\S")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("+")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v(")")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("{2,}")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("\\S\\s")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("*$")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("/")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      reply: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'空格警察，出动！'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    }, {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      match:")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v(" /")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("^")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("(")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v(".")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("+")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v(")一时爽")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("$")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("/")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("reply")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("_")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("str")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("`一直")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("${")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("str")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("}")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("一直爽`")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    }],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  }]],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("awsl")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("爱我苏联")]),t._v(" "),a("chat-message",{attrs:{nickname:"Bob",color:"#00994d"}},[t._v("久 等 了")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("空格警察，出动！")]),t._v(" "),a("chat-message",{attrs:{nickname:"Carol",color:"#1e90ff"}},[t._v("挖坑一时爽")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("一直挖坑一直爽")])],1),t._v(" "),a("p",[t._v("其中 "),a("code",[t._v("match")]),t._v(" 可以是一个字符串或正则表达式，用来表示要匹配的内容；"),a("code",[t._v("reply")]),t._v(" 可以是一个字符串或传入字符串的函数，用来表示输出的结果。"),a("code",[t._v("respondent")]),t._v(" 数组会按照从上到下的顺序进行匹配。")]),t._v(" "),a("p",[t._v("如果想要加入更高级和用户可定义的问答系统，可以参见 "),a("RouterLink",{attrs:{to:"/plugins/teach.html"}},[t._v("koishi-plugin-teach")]),t._v("。")],1),t._v(" "),a("h2",{attrs:{id:"配置复读机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置复读机"}},[t._v("#")]),t._v(" 配置复读机")]),t._v(" "),a("p",[t._v("复读功能一直是很多机器人的传统艺能，但是 Koishi 敢说自己能做得更多。利用内置的复读插件，你的机器人不仅可以实现概率复读，还可以概率打断，甚至可以检测他人重复复读或打断复读的行为并做出回应。让我们开始吧！")]),t._v(" "),a("h3",{attrs:{id:"控制复读时机和概率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#控制复读时机和概率"}},[t._v("#")]),t._v(" 控制复读时机和概率")]),t._v(" "),a("p",[t._v("首先让我们看一个最简单的例子。如果我们希望让机器人在复读进行到第 3 次时参与复读，且此后不再参与，我们可以这样配置：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:"koishi.config.js"}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("module")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("exports")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  plugins: [[")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'common'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    repeater: {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("repeat")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("repeated")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("times")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" times ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("===")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("3")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    },")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  }]],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Bob",color:"#00994d"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Carol",color:"#1e90ff"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Dave",color:"#f4a460"}},[t._v("foo")])],1),t._v(" "),a("p",[t._v("我们可以看到，上面显示的 "),a("code",[t._v("repeat")]),t._v(" 参数是一个函数，传入的第一个参数表示是否已经复读过，第二个参数表示全员已经复读过的次数（包括自己）。这个函数的返回值如果是 truthy，那么机器人就会触发一次复读。")]),t._v(" "),a("p",[t._v("下面我们加入一些概率因素，让机器人的行为变得更不可控一些，例如让每次仅有 50% 的概率触发复读：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:"koishi.config.js"}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("module")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("exports")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  plugins: [[")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'common'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    repeater: {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#88846F"}},[t._v("// 因为不知道具体是哪次复读的，所以可以用 !repeated 确保只复读一次")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("repeat")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("repeated")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("times")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("!")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("repeated ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("&&")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" times ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(">=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("4")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("&&")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("Math")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("random")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("() ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("<")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("0.5")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    },")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  }]],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("h3",{attrs:{id:"自动打断复读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动打断复读"}},[t._v("#")]),t._v(" 自动打断复读")]),t._v(" "),a("p",[t._v("不过有时我们也不希望机器人复读所有的内容，因此我们可以让机器人自动打断某些复读：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:"koishi.config.js"}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("module")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("exports")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  plugins: [[")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'common'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    repeater: {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#88846F"}},[t._v("// 传入的第三个参数是最后收到的发言内容")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("interrupt")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("_")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("times")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("message")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" times ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(">=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("2")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("&&")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" message ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("===")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'这机器人又开始复读了'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      interruptText: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'打断复读！'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    },")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  }]],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("这机器人又开始复读了")]),t._v(" "),a("chat-message",{attrs:{nickname:"Bob",color:"#00994d"}},[t._v("这机器人又开始复读了")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("打断复读！")])],1),t._v(" "),a("h3",{attrs:{id:"检测重复复读和打断复读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检测重复复读和打断复读"}},[t._v("#")]),t._v(" 检测重复复读和打断复读")]),t._v(" "),a("p",[t._v("除此以外，我们还可以让 Koishi 对他人重复复读和打断复读的行为作出回应。例如，如果你想让你的机器人在一条信息已经复读过 5 次以上，且自己也已经复读过后，对任何打断复读的人以 50% 的概率出警，同时对所有将同一句话复读 2 次的用户也作出警告。你可以这样配置：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:"koishi.config.js"}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("module")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("exports")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  plugins: [[")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'common'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    repeater: {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#88846F"}},[t._v("// 检测重复复读")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      repeatCheck: ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("true")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      repeatCheckText: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'不许重复复读！'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#88846F"}},[t._v("// 检测打断复读")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("interruptCheck")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("repeated")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(", ")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("times")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" repeated ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("&&")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" times ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(">=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("3")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("&&")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("Math")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(".")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("random")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("() ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(">")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("0.5")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("      ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("interruptCheckText")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("`[CQ:at,qq=")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("${")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("}")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("] 在？为什么打断复读？`")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("    },")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  }]],")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Bob",color:"#00994d"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("foo")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[t._v("不许重复复读！")])],1),t._v(" "),a("panel-view",{attrs:{title:"聊天记录"}},[a("chat-message",{attrs:{nickname:"Alice",color:"#cc0066"}},[t._v("bar")]),t._v(" "),a("chat-message",{attrs:{nickname:"Bob",color:"#00994d"}},[t._v("bar")]),t._v(" "),a("chat-message",{attrs:{nickname:"Carol",color:"#1e90ff"}},[t._v("bar")]),t._v(" "),a("chat-message",{attrs:{nickname:"Dave",color:"#f4a460"}},[t._v("打断复读")]),t._v(" "),a("chat-message",{attrs:{nickname:"Koishi",avatar:"/koishi.png"}},[a("strong",[t._v("@Dave")]),t._v(" 在？为什么打断复读？")])],1),t._v(" "),a("h3",{attrs:{id:"完整的配置项参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#完整的配置项参考"}},[t._v("#")]),t._v(" 完整的配置项参考")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:""}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("type SessionSwitch = boolean | ((repeated: boolean, times: number, message: string) => boolean)")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("type SessionText = string | ((userId: number, message: string) => string)")])]),t._v("\n\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("interface RepeaterOptions {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  repeat: SessionSwitch")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interrupt: SessionSwitch")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  repeatCheck: SessionSwitch")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interruptCheck: SessionSwitch")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interruptText: SessionText")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  repeatCheckText: SessionText")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interruptCheckText: SessionText")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])]),a("p",[t._v("其中，四个 "),a("code",[t._v("SessionSwitch")]),t._v(" 都会根据返回值是否为 truthy 做出相应的回应；三个 "),a("code",[t._v("SessionText")]),t._v(" 会根据返回的字符串进行输出。对于其他人的复读行为，各个回应的优先级为 repeatCheck > interrupt > repeat。而默认的行为如下图：")]),t._v(" "),a("panel-view",{staticClass:"code",attrs:{title:""}},[a("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[a("code",[a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#66D9EF"}},[t._v("const")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" defaultOptions")]),a("span",{staticStyle:{color:"#F92672"}},[t._v(":")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("RepeaterOptions")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("=")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" {")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  repeat: ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("false")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interrupt: ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("false")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interruptText: ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("'打断复读！'")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  repeatCheck: ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("false")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("repeatCheckText")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("`[CQ:at,qq=")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("${")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("}")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("] 在？为什么重复复读？`")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  interruptCheck: ")]),a("span",{staticStyle:{color:"#AE81FF"}},[t._v("false")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  ")]),a("span",{staticStyle:{color:"#A6E22E"}},[t._v("interruptCheckText")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(": (")]),a("span",{staticStyle:{color:"#FD971F"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(") ")]),a("span",{staticStyle:{color:"#66D9EF"}},[t._v("=>")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("`[CQ:at,qq=")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("${")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("userId")]),a("span",{staticStyle:{color:"#F92672"}},[t._v("}")]),a("span",{staticStyle:{color:"#E6DB74"}},[t._v("] 在？为什么打断复读？`")]),a("span",{staticStyle:{color:"#F8F8F2"}},[t._v(",")])]),t._v("\n"),a("span",{staticClass:"line"},[a("span",{staticStyle:{color:"#F8F8F2"}},[t._v("}")])])])])])],1)}),[],!1,null,null,null);s.default=l.exports}}]);