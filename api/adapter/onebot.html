<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>平台：OneBot | Koishi</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/koishi.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#5546a3">
    
    <link rel="preload" href="/assets/css/0.styles.8731e940.css" as="style"><link rel="preload" href="/assets/js/app.cd7094d9.js" as="script"><link rel="preload" href="/assets/js/2.9ff48064.js" as="script"><link rel="preload" href="/assets/js/9.4a353ef9.js" as="script"><link rel="preload" href="/assets/js/13.d0502719.js" as="script"><link rel="preload" href="/assets/js/6.cc3a06ff.js" as="script"><link rel="preload" href="/assets/js/5.1ec24116.js" as="script"><link rel="prefetch" href="/assets/js/10.8d0d4c51.js"><link rel="prefetch" href="/assets/js/11.9c87e860.js"><link rel="prefetch" href="/assets/js/12.f46b7af2.js"><link rel="prefetch" href="/assets/js/14.9171b1b4.js"><link rel="prefetch" href="/assets/js/15.d5c9f0e0.js"><link rel="prefetch" href="/assets/js/16.65417a98.js"><link rel="prefetch" href="/assets/js/17.9116f370.js"><link rel="prefetch" href="/assets/js/18.baac99cb.js"><link rel="prefetch" href="/assets/js/19.678723f8.js"><link rel="prefetch" href="/assets/js/20.a5228916.js"><link rel="prefetch" href="/assets/js/21.53cda660.js"><link rel="prefetch" href="/assets/js/22.9e9100e8.js"><link rel="prefetch" href="/assets/js/23.25310c0f.js"><link rel="prefetch" href="/assets/js/24.087d1361.js"><link rel="prefetch" href="/assets/js/25.2f79e408.js"><link rel="prefetch" href="/assets/js/26.9b79ab98.js"><link rel="prefetch" href="/assets/js/27.a7d44d0f.js"><link rel="prefetch" href="/assets/js/28.21f31302.js"><link rel="prefetch" href="/assets/js/29.d5e15f81.js"><link rel="prefetch" href="/assets/js/3.6fe66a2c.js"><link rel="prefetch" href="/assets/js/30.251e6baa.js"><link rel="prefetch" href="/assets/js/31.334484c7.js"><link rel="prefetch" href="/assets/js/32.8f981c6d.js"><link rel="prefetch" href="/assets/js/33.6d310169.js"><link rel="prefetch" href="/assets/js/34.304a8fcd.js"><link rel="prefetch" href="/assets/js/35.b2c1f496.js"><link rel="prefetch" href="/assets/js/36.4b1ae0e5.js"><link rel="prefetch" href="/assets/js/37.8fb6b29b.js"><link rel="prefetch" href="/assets/js/38.36d1e749.js"><link rel="prefetch" href="/assets/js/39.eee30141.js"><link rel="prefetch" href="/assets/js/4.8d41e874.js"><link rel="prefetch" href="/assets/js/40.1b3311ac.js"><link rel="prefetch" href="/assets/js/41.6e54118f.js"><link rel="prefetch" href="/assets/js/42.852c32dd.js"><link rel="prefetch" href="/assets/js/43.bd613188.js"><link rel="prefetch" href="/assets/js/44.e92ac662.js"><link rel="prefetch" href="/assets/js/45.26164691.js"><link rel="prefetch" href="/assets/js/46.a9d18d74.js"><link rel="prefetch" href="/assets/js/47.da16f5d4.js"><link rel="prefetch" href="/assets/js/48.2c33e213.js"><link rel="prefetch" href="/assets/js/49.dd45a410.js"><link rel="prefetch" href="/assets/js/50.ca2af0a0.js"><link rel="prefetch" href="/assets/js/51.3be595bd.js"><link rel="prefetch" href="/assets/js/52.3737ab79.js"><link rel="prefetch" href="/assets/js/53.79425dd4.js"><link rel="prefetch" href="/assets/js/54.d7411943.js"><link rel="prefetch" href="/assets/js/55.0ffc3d14.js"><link rel="prefetch" href="/assets/js/56.86b19261.js"><link rel="prefetch" href="/assets/js/57.9a8409f6.js"><link rel="prefetch" href="/assets/js/58.0b855ac4.js"><link rel="prefetch" href="/assets/js/59.7294007f.js"><link rel="prefetch" href="/assets/js/60.8db2dc8c.js"><link rel="prefetch" href="/assets/js/61.a0f9d125.js"><link rel="prefetch" href="/assets/js/62.7e117980.js"><link rel="prefetch" href="/assets/js/63.055c882a.js"><link rel="prefetch" href="/assets/js/64.72229f83.js"><link rel="prefetch" href="/assets/js/65.2ee92b65.js"><link rel="prefetch" href="/assets/js/66.65269c36.js"><link rel="prefetch" href="/assets/js/67.0dab4039.js"><link rel="prefetch" href="/assets/js/68.6e06140c.js"><link rel="prefetch" href="/assets/js/69.393bca84.js"><link rel="prefetch" href="/assets/js/7.ea3c96e0.js"><link rel="prefetch" href="/assets/js/70.19040ac4.js"><link rel="prefetch" href="/assets/js/71.9e258746.js"><link rel="prefetch" href="/assets/js/8.c9d84004.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8731e940.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/koishi.png" alt="Koishi" class="logo"> <span class="site-name can-hide">Koishi</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/intro/starter.html" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">
  官方插件
</a></div><div class="nav-item"><a href="https://github.com/koishijs/koishi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/guide/intro/starter.html" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><a href="/plugins/" class="nav-link">
  官方插件
</a></div><div class="nav-item"><a href="https://github.com/koishijs/koishi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/api/" aria-current="page" class="sidebar-link">总览</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>核心 API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/context.html" class="sidebar-link">上下文 (Context)</a></li><li><a href="/api/app.html" class="sidebar-link">应用 (App)</a></li><li><a href="/api/bot.html" class="sidebar-link">机器人 (Bot)</a></li><li><a href="/api/events.html" class="sidebar-link">事件 (Events)</a></li><li><a href="/api/session.html" class="sidebar-link">会话 (Session)</a></li><li><a href="/api/command.html" class="sidebar-link">指令 (Command)</a></li><li><a href="/api/database.html" class="sidebar-link">数据库 (Database)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>其他官方包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/utils.html" class="sidebar-link">常用工具 (Utils)</a></li><li><a href="/api/test-utils.html" class="sidebar-link">测试工具 (Test Utils)</a></li><li><a href="/api/adapter/onebot.html" aria-current="page" class="active sidebar-link">平台：OneBot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#机制说明" class="sidebar-link">机制说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#异步调用" class="sidebar-link">异步调用</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#快捷回复" class="sidebar-link">快捷回复</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#http-和-websocket-应该如何选择？" class="sidebar-link">HTTP 和 WebSocket 应该如何选择？</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#事件" class="sidebar-link">事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#事件：heartbeat" class="sidebar-link">事件：heartbeat</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#事件：lifecycle" class="sidebar-link">事件：lifecycle</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#app-构造函数选项" class="sidebar-link">App 构造函数选项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-path" class="sidebar-link">options.path</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-secret" class="sidebar-link">options.secret</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-bots-server" class="sidebar-link">options(.bots[]).server</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-bots-token" class="sidebar-link">options(.bots[]).token</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-retrytimes" class="sidebar-link">options.retryTimes</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-retryinterval" class="sidebar-link">options.retryInterval</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#options-quickoperation" class="sidebar-link">options.quickOperation</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#发送消息" class="sidebar-link">发送消息</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-sendgroupmsg" class="sidebar-link">bot.sendGroupMsg()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-sendgroupforwardmsg" class="sidebar-link">bot.sendGroupForwardMsg()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-sendlike" class="sidebar-link">bot.sendLike()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgroupmsg" class="sidebar-link">bot.getGroupMsg()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getforwardmsg" class="sidebar-link">bot.getForwardMsg()</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#群相关" class="sidebar-link">群相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupkick" class="sidebar-link">bot.setGroupKick()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupban" class="sidebar-link">bot.setGroupBan()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupanonymousban" class="sidebar-link">bot.setGroupAnonymousBan()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupwholeban" class="sidebar-link">bot.setGroupWholeBan()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupadmin" class="sidebar-link">bot.setGroupAdmin()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupanonymous" class="sidebar-link">bot.setGroupAnonymous()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupcard" class="sidebar-link">bot.setGroupCard()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupleave" class="sidebar-link">bot.setGroupLeave()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupspecialtitle" class="sidebar-link">bot.setGroupSpecialTitle()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-sendgroupnotice" class="sidebar-link">bot.sendGroupNotice()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupname" class="sidebar-link">bot.setGroupName()</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#处理请求" class="sidebar-link">处理请求</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setfriendaddrequest" class="sidebar-link">bot.setFriendAddRequest()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setgroupaddrequest" class="sidebar-link">bot.setGroupAddRequest()</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#账号信息" class="sidebar-link">账号信息</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getlogininfo" class="sidebar-link">bot.getLoginInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getvipinfo" class="sidebar-link">bot.getVipInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getstrangerinfo" class="sidebar-link">bot.getStrangerInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getfriendlist" class="sidebar-link">bot.getFriendList()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgrouplist" class="sidebar-link">bot.getGroupList()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgroupinfo" class="sidebar-link">bot.getGroupInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgroupmemberinfo" class="sidebar-link">bot.getGroupMemberInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgroupmemberlist" class="sidebar-link">bot.getGroupMemberList()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getgroupnotice" class="sidebar-link">bot.getGroupNotice()</a></li></ul></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#其他操作" class="sidebar-link">其他操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getcookies" class="sidebar-link">bot.getCookies()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getcsrftoken" class="sidebar-link">bot.getCsrfToken()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getcredentials" class="sidebar-link">bot.getCredentials()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getrecord" class="sidebar-link">bot.getRecord()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getimage" class="sidebar-link">bot.getImage()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-cansendimage" class="sidebar-link">bot.canSendImage()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-cansendrecord" class="sidebar-link">bot.canSendRecord()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getstatus" class="sidebar-link">bot.getStatus()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-getversioninfo" class="sidebar-link">bot.getVersionInfo()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setrestart" class="sidebar-link">bot.setRestart()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-setrestartplugin" class="sidebar-link">bot.setRestartPlugin()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-cleandatadir" class="sidebar-link">bot.cleanDataDir()</a></li><li class="sidebar-sub-header"><a href="/api/adapter/onebot.html#bot-cleanpluginlog" class="sidebar-link">bot.cleanPluginLog()</a></li></ul></li></ul></li><li><a href="/api/adapter/kaiheila.html" class="sidebar-link">平台：Kaiheila</a></li><li><a href="/api/database/mongo.html" class="sidebar-link">数据库：Mongo</a></li><li><a href="/api/database/mysql.html" class="sidebar-link">数据库：MySQL</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>更新与迁移</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/api/changelog.html" class="sidebar-link">v3 更新日志</a></li><li><a href="/api/migration.html" class="sidebar-link">从旧版本迁移</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="koishi-adapter-onebot"><a href="#koishi-adapter-onebot" class="header-anchor">#</a> koishi-adapter-onebot</h1> <p><a href="https://github.com/howmanybots/onebot" target="_blank" rel="noopener noreferrer">OneBot<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (旧名 CQHTTP) 是一个聊天机器人应用接口标准，目前可用于 QQ 机器人。要使用 koishi-adapter-onebot，你需要首先下载一个实现该协议的框架：</p> <ul><li><a href="https://github.com/Mrs4s/go-cqhttp" target="_blank" rel="noopener noreferrer">Mrs4s/go-cqhttp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（推荐）</li> <li><a href="https://github.com/yyuueexxiinngg/cqhttp-mirai" target="_blank" rel="noopener noreferrer">yyuueexxiinngg/cqhttp-mirai<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/richardchien/coolq-http-api" target="_blank" rel="noopener noreferrer">richardchien/coolq-http-api<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（配合 <a href="https://github.com/iTXTech/mirai-native" target="_blank" rel="noopener noreferrer">iTXTech/mirai-native<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 使用）</li></ul> <p>上述框架也在 OneBot 的基础上扩展了各自的接口，而这些扩展的功能也被包含在了 koishi-adapter-onebot 中。</p> <ul><li>标有 <span class="badge warn" style="vertical-align:baseline;" data-v-15b7b770>go-cqhttp</span> 的 API 只能基于 go-cqhttp 运行</li></ul> <h2 id="机制说明"><a href="#机制说明" class="header-anchor">#</a> 机制说明</h2> <h3 id="异步调用"><a href="#异步调用" class="header-anchor">#</a> 异步调用</h3> <p>OneBot 提出了<strong>异步调用</strong>的概念，当 OneBot 服务器受到异步调用请求时，如果调用正确，将直接返回 200。这样做的好处是，如果某些操作有较长的耗时（例如发送含有大量图片的消息或清空数据目录等）或你不关心调用结果，使用异步调用可以有效防止阻塞。下面说明了异步调用和普通调用的关系：</p> <p><img src="/async-method.png" alt="async-method"></p> <p>但是另一方面，你也无法得知异步调用是否成功被执行。与此同时，没有副作用的异步调用也毫无意义（因为这些调用本身就是为了获取某些信息，但是异步调用是无法获取调用结果的）。因此，Koishi 为除此以外的所有异步调用都提供了 API，它们的调用接口与非异步的版本除了在方法后面加了一个 <code>Async</code> 外没有任何区别：</p> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#88846F;">// 普通版本</span></span>
<span class="line"><span style="color:#66D9EF;">const</span><span style="color:#F8F8F2;"> messageId </span><span style="color:#F92672;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> app.sender.</span><span style="color:#A6E22E;">sendPrivateMsg</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">123456789</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">'Hello world'</span><span style="color:#F8F8F2;">)</span></span>

<span class="line"><span style="color:#88846F;">// 异步版本，无法获得调用结果</span></span>
<span class="line"><span style="color:#F92672;">await</span><span style="color:#F8F8F2;"> app.sender.</span><span style="color:#A6E22E;">sendPrivateMsgAsync</span><span style="color:#F8F8F2;">(</span><span style="color:#AE81FF;">123456789</span><span style="color:#F8F8F2;">, </span><span style="color:#E6DB74;">'Hello world'</span><span style="color:#F8F8F2;">)</span></span></code></pre></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>虽然异步调用方法的名字以 Async 结尾，但是其他方法也是<strong>异步函数</strong>，它们都会返回一个 <code>Promise</code> 对象。取这样的名字只是为了与 OneBot 保持一致。</p></div> <h3 id="快捷回复"><a href="#快捷回复" class="header-anchor">#</a> 快捷回复</h3> <p>Meta 对象还提供了一个快捷回复方法 <code>session.send</code>，调用它可以快速实现对原消息的回复。快捷操作的响应速度会高于普通的 Sender API 调用，但是默认情况下这种操作同上面的异步调用一样，这些操作也是无法获得调用结果的。完整的快捷操作列表参见 <a href="#koishi-%E6%B7%BB%E5%8A%A0%E7%9A%84%E5%B1%9E%E6%80%A7">Koishi 添加的属性</a>。</p> <p>这里也简单介绍一下快捷操作的原理。当正常使用 HTTP 模式时，每个事件上报和 API 调用都使用了不同的连接。那么快捷操作则相当于将 API 调用作为事件上报的响应。当然，这种做法有着很多限制，例如对 WebSocket 无效，同一个事件只能响应一次，以及需要手动处理响应超时的问题。因此，默认情况下这种优化是不开启的。如果手动配置了 <code>quickOperationTimeout</code>，则会将这个配置项作为时间限制，在这个时间限制内第一个调用快捷操作的会享受这种优化（事实上大部分操作都只有一个响应，所以这种优化对 HTTP 往往是非常有效的），之后的所有快捷操作调用都会自动转化为异步调用，这样可以保证快捷操作永远都是可用的。</p> <p>下面这张图比较了使用 HTTP 时，快捷操作与默认机制的区别：</p> <p><img src="/quick-operation.png" alt="quick-operation"></p> <h3 id="http-和-websocket-应该如何选择？"><a href="#http-和-websocket-应该如何选择？" class="header-anchor">#</a> HTTP 和 WebSocket 应该如何选择？</h3> <p>目前 Koishi 已经完全实现了 OneBot 提供的 HTTP 和 WebSocket 通信方式，因此它们之间<strong>不存在任何功能上的差别</strong>。</p> <p>但是，HTTP 需要 Koishi 和 OneBot 所处于同一台机器，或所处的机器都拥有公网 IP；而 WebSocket 只需要 Koishi 和 OneBot 所处于同一台机器，或运行 OneBot 的机器拥有公网 IP。因此如果你在服务端运行 CoolQ，同时在个人电脑上调试你的 Koishi 应用，你应当选择使用 WebSocket 模式。</p> <p>从性能上说，WebSocket 占用的资源会更少（因为不需要每次都建立连接），但是响应速度可能不如 HTTP；另一方面，当一个 Koishi 应用同时管理着多个机器人时，HTTP 能通过快捷调用和服务器复用的方式来提高性能，但是 WebSocket 并没有这些机制。</p> <h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <p>metaEvent 系列事件对应这 CQHTTP 插件本身的元事件，<strong>只会在 App 实例触发</strong>。所有这些事件的回调函数都会传入一个 <a href="/api/guide/message.html#深入-meta-对象"><code>Meta</code> 对象</a>。这些事件的共同点是 <code>meta.postType</code> 都为 <code>'meta_event'</code>。</p> <h3 id="事件：heartbeat"><a href="#事件：heartbeat" class="header-anchor">#</a> 事件：heartbeat</h3> <p>心跳元事件，<strong>仅对 WebSocket 生效</strong>。产生此事件需要通过将配置项 <code>enable_heartbeat</code> 设置为 <code>true</code>，并可通过 <code>heartbeat_interval</code> 配置心跳间隔（单位毫秒）。</p> <h3 id="事件：lifecycle"><a href="#事件：lifecycle" class="header-anchor">#</a> 事件：lifecycle</h3> <p>生命周期事件，<strong>仅对 HTTP 生效</strong>。拥有下面的子事件：</p> <ul><li>lifecycle/enable: CQHTTP 插件启用</li> <li>lifecycle/disable: CQHTTP 插件停用</li> <li>lifecycle/connect: 成功建立 WebSocket 连接</li></ul> <h2 id="app-构造函数选项"><a href="#app-构造函数选项" class="header-anchor">#</a> App 构造函数选项</h2> <p>下面的配置项来自 koishi-adapter-cqhttp。你需要将你的 <a href="#options-type"><code>type</code></a> 字段配置为 <code>cqhttp</code>, <code>cqhttp:http</code>, <code>cqhttp:ws</code> 或 <code>cqhttp:ws-reverse</code> 中的一种。如果缺省或使用了 <code>cqhttp</code>，Koishi 会读取你的 <code>server</code> 选项，根据你配置的服务器 URL 进行适配。</p> <p>相关 OneBot 配置：<code>use_http</code>, <code>use_ws</code>。</p> <h3 id="options-path"><a href="#options-path" class="header-anchor">#</a> options.path</h3> <ul><li>类型：<code>string</code></li></ul> <p>服务器监听的路径。相关 OneBot 配置：<code>post_url</code>。</p> <h3 id="options-secret"><a href="#options-secret" class="header-anchor">#</a> options.secret</h3> <ul><li>类型：<code>string</code></li></ul> <p>接收信息时用于验证的字段，应与 OneBot 的 <code>secret</code> 配置保持一致。</p> <h3 id="options-bots-server"><a href="#options-bots-server" class="header-anchor">#</a> options(.bots[]).server</h3> <ul><li>类型：<code>string</code></li></ul> <p>如果使用了 HTTP，则该配置将作为发送信息的服务端；如果使用了 WebSocket，则该配置将作为监听事件和发送信息的服务端。</p> <p>相关 OneBot 配置：<code>host</code>, <code>port</code>, <code>ws_host</code>, <code>ws_port</code>。</p> <h3 id="options-bots-token"><a href="#options-bots-token" class="header-anchor">#</a> options(.bots[]).token</h3> <ul><li>类型：<code>string</code></li></ul> <p>发送信息时用于验证的字段，应与 OneBot 的 <code>access_token</code> 配置保持一致。</p> <h3 id="options-retrytimes"><a href="#options-retrytimes" class="header-anchor">#</a> options.retryTimes</h3> <ul><li>类型：<code>number</code></li></ul> <p>WebSocket 允许重新连接的次数。默认值为 <code>0</code>。</p> <h3 id="options-retryinterval"><a href="#options-retryinterval" class="header-anchor">#</a> options.retryInterval</h3> <ul><li>类型：<code>number</code></li></ul> <p>WebSocket 重新尝试连接前的等待时间，单位为毫秒。默认值为 <code>5000</code>。</p> <h3 id="options-quickoperation"><a href="#options-quickoperation" class="header-anchor">#</a> options.quickOperation</h3> <ul><li>类型：<code>number</code></li></ul> <p>快捷操作的时间限制，单位为毫秒。如果配置了这个选项且使用了 HTTP 通信方式，则在这段时间内的首次调用 <code>meta.send()</code> 或类似的方法将不产生新的 HTTP 请求。默认值为 <code>100</code>。参见 <a href="/api/guide/message.html#快捷操作"><strong>快捷操作</strong></a> 一节。</p> <h2 id="发送消息"><a href="#发送消息" class="header-anchor">#</a> 发送消息</h2> <h3 id="bot-sendgroupmsg"><a href="#bot-sendgroupmsg" class="header-anchor">#</a> bot.sendGroupMsg(groupId, message, autoEscape?)</h3> <p>发送群消息。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>message:</strong> <code>string</code> 要发送的内容</li> <li><strong>autoEsacpe:</strong> <code>boolean</code> 消息内容是否作为纯文本发送（即不解析 CQ 码）</li> <li>返回值: <code>Promise&lt;number&gt;</code> 新信息的 messageId</li></ul> <h3 id="bot-sendgroupforwardmsg"><a href="#bot-sendgroupforwardmsg" class="header-anchor">#</a> bot.sendGroupForwardMsg(groupId, nodes) <span class="badge warn" style="vertical-align:top;" data-v-15b7b770>go-cqhttp</span></h3> <p>发送群批量转发消息。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>nodes:</strong> <code>CQNode[]</code> 消息节点列表</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">CQNode</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  type</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'node'</span></span>
<span class="line"><span style="color:#F8F8F2;">  data</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    id</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  } </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    name</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">    uin</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">    content</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-sendlike"><a href="#bot-sendlike" class="header-anchor">#</a> bot.sendLike(userId, times?)</h3> <p>给好友点赞。</p> <ul><li><strong>userId:</strong> <code>number</code> 好友 QQ 号</li> <li><strong>times:</strong> <code>number</code> 点赞次数</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>本接口仅限<strong>对好友</strong>使用。</p></div> <h3 id="bot-getgroupmsg"><a href="#bot-getgroupmsg" class="header-anchor">#</a> bot.getGroupMsg(messageId) <span class="badge warn" style="vertical-align:top;" data-v-15b7b770>go-cqhttp</span></h3> <p>发送群批量转发消息。</p> <ul><li><strong>messageId:</strong> <code>number</code> 消息编号</li> <li>返回值: <code>Promise&lt;GroupMessage&gt;</code></li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">GroupMessage</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  messageId</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  realId</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  sender</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span></span>
<span class="line"><span style="color:#F8F8F2;">  time</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  content</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getforwardmsg"><a href="#bot-getforwardmsg" class="header-anchor">#</a> bot.getForwardMsg(messageId) <span class="badge warn" style="vertical-align:top;" data-v-15b7b770>go-cqhttp</span></h3> <p>发送群批量转发消息。</p> <ul><li><strong>messageId:</strong> <code>number</code> 消息编号</li> <li>返回值: <code>Promise&lt;ForwardMessage&gt;</code></li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">ForwardMessage</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  messages</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    sender</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span></span>
<span class="line"><span style="color:#F8F8F2;">    time</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">    content</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  }[]</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h2 id="群相关"><a href="#群相关" class="header-anchor">#</a> 群相关</h2> <h3 id="bot-setgroupkick"><a href="#bot-setgroupkick" class="header-anchor">#</a> bot.setGroupKick(groupId, userId, rejectAddRequest?)</h3> <p>踢出群聊或拒绝加群。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>userId:</strong> <code>number</code> QQ 号</li> <li><strong>rejectAddRequest:</strong> <code>boolean</code> 拒绝此人的加群请求</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupban"><a href="#bot-setgroupban" class="header-anchor">#</a> bot.setGroupBan(groupId, userId, duration?)</h3> <p>群组单人禁言。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>userId:</strong> <code>number</code> QQ 号</li> <li><strong>duration:</strong> <code>number</code> 禁言时长（秒），设为 0 表示解除禁言</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupanonymousban"><a href="#bot-setgroupanonymousban" class="header-anchor">#</a> bot.setGroupAnonymousBan(groupId, anonymous, duration?)</h3> <p>群组匿名用户禁言。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>anonymous:</strong> <code>object | string</code> 匿名用户的信息或 flag，参见 <a href="/api/guide/message.html#message-型元数据属性">Message 型元数据属性</a></li> <li><strong>duration:</strong> <code>number</code> 禁言时长（秒），设为 0 表示解除禁言</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupwholeban"><a href="#bot-setgroupwholeban" class="header-anchor">#</a> bot.setGroupWholeBan(groupId, enable?)</h3> <p>群组全员禁言。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>enable:</strong> <code>boolean</code> 是否禁言，默认为 <code>true</code></li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupadmin"><a href="#bot-setgroupadmin" class="header-anchor">#</a> bot.setGroupAdmin(groupId, userId, enable?)</h3> <p>群组设置管理员。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>userId:</strong> <code>number</code> QQ 号</li> <li><strong>enable:</strong> <code>boolean</code> 是否设置为管理员，默认为 <code>true</code></li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupanonymous"><a href="#bot-setgroupanonymous" class="header-anchor">#</a> bot.setGroupAnonymous(groupId, enable?)</h3> <p>群组设置匿名。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>enable:</strong> <code>boolean</code> 是否允许匿名，默认为 <code>true</code></li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupcard"><a href="#bot-setgroupcard" class="header-anchor">#</a> bot.setGroupCard(groupId, userId, card?)</h3> <p>设置群名片。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>userId:</strong> <code>number</code> QQ 号</li> <li><strong>card:</strong> <code>string</code> 群名片</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupleave"><a href="#bot-setgroupleave" class="header-anchor">#</a> bot.setGroupLeave(groupId, isDismiss?)</h3> <p>退出群组。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>isDismiss:</strong> <code>boolean</code> 是否解散群（仅对群主生效）</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupspecialtitle"><a href="#bot-setgroupspecialtitle" class="header-anchor">#</a> bot.setGroupSpecialTitle(groupId, userId, specialTitle?, duration?)</h3> <p>设置群组专属头衔。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>userId:</strong> <code>number</code> QQ 号</li> <li><strong>specialTitle:</strong> <code>string</code> 专属头衔</li> <li><strong>duration:</strong> <code>number</code> 有效时长（秒，目前可能没用）</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-sendgroupnotice"><a href="#bot-sendgroupnotice" class="header-anchor">#</a> bot.sendGroupNotice(groupId, title, content)</h3> <p>发布群公告。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>title:</strong> <code>string</code> 标题</li> <li><strong>content:</strong> <code>string</code> 内容</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupname"><a href="#bot-setgroupname" class="header-anchor">#</a> bot.setGroupName(groupId, name) <span class="badge warn" style="vertical-align:top;" data-v-15b7b770>go-cqhttp</span></h3> <p>修改群名称。</p> <ul><li><strong>groupId:</strong> <code>number</code> 群号</li> <li><strong>name:</strong> <code>string</code> 群名称</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h2 id="处理请求"><a href="#处理请求" class="header-anchor">#</a> 处理请求</h2> <h3 id="bot-setfriendaddrequest"><a href="#bot-setfriendaddrequest" class="header-anchor">#</a> bot.setFriendAddRequest(flag, approve?, remark?)</h3> <p>处理加好友请求。</p> <ul><li><strong>flag:</strong> <code>string</code> 加好友请求的 flag（需从上报的数据中获得）</li> <li><strong>approve:</strong> <code>boolean</code> 是否同意请求，默认为 <code>true</code></li> <li><strong>remark:</strong> <code>string</code> 好友备注名（仅当同意时有效）</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-setgroupaddrequest"><a href="#bot-setgroupaddrequest" class="header-anchor">#</a> bot.setGroupAddRequest(flag, subtype, approve?, reason?)</h3> <p>处理加群请求或邀请。</p> <ul><li><strong>flag:</strong> <code>string</code> 加群请求的 flag（需从上报的数据中获得）</li> <li><strong>subtype:</strong> <code>'add' | 'invite'</code> 子类型，参见 <a href="/api/guide/message.html#request-型元数据属性">Request 型元数据属性</a></li> <li><strong>approve:</strong> <code>boolean</code> 是否同意请求，默认为 <code>true</code></li> <li><strong>reason:</strong> <code>string</code> 拒绝理由（仅当拒绝时有效）</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h2 id="账号信息"><a href="#账号信息" class="header-anchor">#</a> 账号信息</h2> <h3 id="bot-getlogininfo"><a href="#bot-getlogininfo" class="header-anchor">#</a> bot.getLoginInfo()</h3> <p>获取登录号信息。</p> <ul><li>返回值: <code>Promise&lt;AccountInfo&gt;</code> 登录号信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  userId</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  nickname</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getvipinfo"><a href="#bot-getvipinfo" class="header-anchor">#</a> bot.getVipInfo()</h3> <p>获取会员信息。</p> <ul><li>返回值: <code>Promise&lt;VipInfo&gt;</code> 会员信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">VipInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  level</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  levelSpeed</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  vipLevel</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  vipGrowthSpeed</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  vipGrowthTotal</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getstrangerinfo"><a href="#bot-getstrangerinfo" class="header-anchor">#</a> bot.getStrangerInfo(userId, noCache?)</h3> <p>获取陌生人信息。</p> <ul><li><strong>userId:</strong> <code>number</code> 目标 QQ 号</li> <li><strong>noCache:</strong> <code>boolean</code> 是否不使用缓存，默认为 <code>false</code></li> <li>返回值: <code>Promise&lt;StrangerInfo&gt;</code> 陌生人信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">StrangerInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  sex</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'male'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'female'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'unknown'</span></span>
<span class="line"><span style="color:#F8F8F2;">  age</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getfriendlist"><a href="#bot-getfriendlist" class="header-anchor">#</a> bot.getFriendList()</h3> <p>获取好友列表。</p> <ul><li>返回值: <code>Promise&lt;FriendInfo[]&gt;</code> 好友列表</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">FriendInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">AccountInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  remark</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getgrouplist"><a href="#bot-getgrouplist" class="header-anchor">#</a> bot.getGroupList()</h3> <p>获取群列表。</p> <ul><li>返回值: <code>Promise&lt;ListedGroupInfo[]&gt;</code> 群信息列表</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">ListedGroupInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  groupId</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  groupName</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getgroupinfo"><a href="#bot-getgroupinfo" class="header-anchor">#</a> bot.getGroupInfo(groupId, noCache?)</h3> <p>获取群信息。</p> <ul><li><strong>groupId:</strong> <code>number</code> 目标群号</li> <li><strong>noCache:</strong> <code>boolean</code> 是否不使用缓存，默认为 <code>false</code></li> <li>返回值: <code>Promise&lt;GroupInfo&gt;</code> 群信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">GroupInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">ListedGroupInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  memberCount</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  maxMemberCount</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getgroupmemberinfo"><a href="#bot-getgroupmemberinfo" class="header-anchor">#</a> bot.getGroupMemberInfo(groupId, userId, noCache?)</h3> <p>获取群成员信息。</p> <ul><li><strong>groupId:</strong> <code>number</code> 目标群号</li> <li><strong>userId:</strong> <code>number</code> 目标 QQ 号</li> <li><strong>noCache:</strong> <code>boolean</code> 是否不使用缓存，默认为 <code>false</code></li> <li>返回值: <code>Promise&lt;GroupMemberInfo&gt;</code> 群成员信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">SenderInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">StrangerInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  area</span><span style="color:#F92672;">?:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  card</span><span style="color:#F92672;">?:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  level</span><span style="color:#F92672;">?:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  role</span><span style="color:#F92672;">?:</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'owner'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'admin'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'member'</span></span>
<span class="line"><span style="color:#F8F8F2;">  title</span><span style="color:#F92672;">?:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>

<span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">GroupMemberInfo</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">extends</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">SenderInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  cardChangeable</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  groupId</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  joinTime</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  lastSentTime</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  titleExpireTime</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  unfriendly</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getgroupmemberlist"><a href="#bot-getgroupmemberlist" class="header-anchor">#</a> bot.getGroupMemberList(groupId)</h3> <p>获取群成员列表。</p> <ul><li><strong>groupId:</strong> <code>number</code> 目标群号</li> <li>返回值: <code>Promise&lt;GroupMemberInfo[]&gt;</code> 群成员列表</li></ul> <h3 id="bot-getgroupnotice"><a href="#bot-getgroupnotice" class="header-anchor">#</a> bot.getGroupNotice(groupId)</h3> <p>获取群公告列表。部分字段具体含义可能需要自行理解。</p> <ul><li><strong>groupId:</strong> <code>number</code> 目标群号</li> <li>返回值: <code>Promise&lt;GroupNoticeInfo[]&gt;</code> 群公告列表</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">GroupNoticeInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  cn</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  fid</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  fn</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  msg</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    text</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">    textFace</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">    title</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">  pubt</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  readNum</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  settings</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    isShowEditCard</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">    remindTs</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">  u</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  vn</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h2 id="其他操作"><a href="#其他操作" class="header-anchor">#</a> 其他操作</h2> <h3 id="bot-getcookies"><a href="#bot-getcookies" class="header-anchor">#</a> bot.getCookies(domain?)</h3> <p>获取 Cookies。</p> <ul><li><strong>domain:</strong> <code>string</code> 需要获取 cookies 的域名</li> <li>返回值: <code>Promise&lt;string&gt;</code> cookies</li></ul> <h3 id="bot-getcsrftoken"><a href="#bot-getcsrftoken" class="header-anchor">#</a> bot.getCsrfToken()</h3> <p>获取 CSRF Token。</p> <ul><li>返回值: <code>Promise&lt;string&gt;</code> CSRF Token</li></ul> <h3 id="bot-getcredentials"><a href="#bot-getcredentials" class="header-anchor">#</a> bot.getCredentials()</h3> <p>获取 QQ 相关接口凭证，相当于上面两个接口的合并。</p> <ul><li><strong>domain:</strong> <code>string</code> 需要获取 cookies 的域名</li> <li>返回值: <code>Promise&lt;Credentials&gt;</code> 接口凭证</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">Credentials</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  cookies</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  csrfToken</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getrecord"><a href="#bot-getrecord" class="header-anchor">#</a> bot.getRecord(file, outFormat, fullPath?)</h3> <p>获取语音：并不是真的获取语音，而是转换语音到指定的格式，然后返回 <code>data/record</code> 目录下的语音文件名。注意，要使用此接口，需要安装 CoolQ 的 <a href="https://cqp.cc/t/21132" target="_blank" rel="noopener noreferrer">语音组件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <ul><li><strong>file:</strong> <code>string</code> 语音文件名</li> <li><strong>outFormat:</strong> <code>'mp3' | 'amr' | 'wma' | 'm4a' | 'spx' | 'ogg' | 'wav' | 'flac'</code></li> <li><strong>fullPath:</strong> <code>boolean</code> 是否返回文件的绝对路径</li> <li>返回值: <code>Promise&lt;RecordInfo&gt;</code></li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">RecordInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  file</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getimage"><a href="#bot-getimage" class="header-anchor">#</a> bot.getImage(file)</h3> <p>获取图片：与上面类似，不过返回 <code>data/image</code> 目录下的图片路径。</p> <ul><li><strong>file:</strong> <code>string</code> 图片文件名</li> <li>返回值: <code>Promise&lt;ImageInfo&gt;</code></li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">ImageInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  file</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>

<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// go-cqhttp 特有</span></span>
<span class="line"><span style="color:#F8F8F2;">  size</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  filename</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  url</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-cansendimage"><a href="#bot-cansendimage" class="header-anchor">#</a> bot.canSendImage()</h3> <p>检查是否可以发送图片。</p> <ul><li>返回值: <code>Promise&lt;boolean&gt;</code> 是否可以发送图片</li></ul> <h3 id="bot-cansendrecord"><a href="#bot-cansendrecord" class="header-anchor">#</a> bot.canSendRecord()</h3> <p>检查是否可以发送语音。</p> <ul><li>返回值: <code>Promise&lt;boolean&gt;</code> 是否可以发送语音</li></ul> <h3 id="bot-getstatus"><a href="#bot-getstatus" class="header-anchor">#</a> bot.getStatus()</h3> <p>获取插件运行状态。</p> <ul><li>返回值: <code>Promise&lt;StatusInfo&gt;</code> 插件运行状态</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">StatusInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  appInitialized</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  appEnabled</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  pluginsGood</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  appGood</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  online</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  good</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-getversioninfo"><a href="#bot-getversioninfo" class="header-anchor">#</a> bot.getVersionInfo()</h3> <p>获取 OneBot 的版本信息。</p> <ul><li>返回值: <code>Promise&lt;VersionInfo&gt;</code> 插件版本信息</li></ul> <div class="panel-view code mini"><div class="controls"><div class="circle red"></div> <div class="circle yellow"></div> <div class="circle green"></div> <div class="title"><span class="title-text"></span> <!----></div></div> <div class="content"><pre class="shiki" style="background-color:#272822;"><code><span class="line"><span style="color:#F92672;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">interface</span><span style="color:#F8F8F2;"> </span><span style="color:#A6E22E;">VersionInfo</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  coolqDirectory</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  coolqEdition</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'air'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'pro'</span></span>
<span class="line"><span style="color:#F8F8F2;">  pluginVersion</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  pluginBuildNumber</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">number</span></span>
<span class="line"><span style="color:#F8F8F2;">  pluginBuildConfiguration</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'debug'</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">'release'</span></span>

<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#88846F;">// go-cqhttp 特有</span></span>
<span class="line"><span style="color:#F8F8F2;">  goCqhttp</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">boolean</span></span>
<span class="line"><span style="color:#F8F8F2;">  runtimeVersion</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">  runtimeOs</span><span style="color:#F92672;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#66D9EF;">string</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span></code></pre></div></div><h3 id="bot-setrestart"><a href="#bot-setrestart" class="header-anchor">#</a> bot.setRestart(cleanLog?, cleanCache?, cleanEvent?)</h3> <p>重启 CoolQ，并以当前登录号自动登录（需勾选快速登录）。</p> <ul><li><strong>cleanLog:</strong> <code>boolean</code> 是否在重启时清空 CoolQ 的日志数据库（log*.db）</li> <li><strong>cleanCache:</strong> <code>boolean</code> 是否在重启时清空 CoolQ 的缓存数据库（cache.db）</li> <li><strong>cleanEvent:</strong> <code>boolean</code> 是否在重启时清空 CoolQ 的事件数据库（eventv2.db）</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <div class="custom-block warning"><p class="custom-block-title">警告</p> <p>由于强行退出可能导致 CoolQ 数据库损坏而影响功能，此接口除非必要请尽量避免使用。</p></div> <h3 id="bot-setrestartplugin"><a href="#bot-setrestartplugin" class="header-anchor">#</a> bot.setRestartPlugin(delay?)</h3> <p>重启 HTTP API 插件。</p> <ul><li><strong>delay:</strong> <code>string</code> 要延迟的毫秒数，如果默认情况下无法重启，可以尝试设置延迟为 2000 左右</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-cleandatadir"><a href="#bot-cleandatadir" class="header-anchor">#</a> bot.cleanDataDir(dataDir)</h3> <p>清理积攒了太多旧文件的数据目录。</p> <ul><li><strong>dataDir:</strong> <code>'image' | 'record' | 'show' | 'bface'</code> 要清理的目录名</li> <li>返回值: <code>Promise&lt;void&gt;</code></li></ul> <h3 id="bot-cleanpluginlog"><a href="#bot-cleanpluginlog" class="header-anchor">#</a> bot.cleanPluginLog()</h3> <p>清空插件的日志文件。</p> <ul><li>返回值: <code>Promise&lt;void&gt;</code></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/koishijs/koishijs.github.io/edit/docs/api/adapter/onebot.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2/4/2021, 6:12:27 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api/test-utils.html" class="prev">
        测试工具 (Test Utils)
      </a></span> <span class="next"><a href="/api/adapter/kaiheila.html">
        平台：Kaiheila
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.cd7094d9.js" defer></script><script src="/assets/js/2.9ff48064.js" defer></script><script src="/assets/js/9.4a353ef9.js" defer></script><script src="/assets/js/13.d0502719.js" defer></script><script src="/assets/js/6.cc3a06ff.js" defer></script><script src="/assets/js/5.1ec24116.js" defer></script>
  </body>
</html>
